library(e1071)
library(mlbench)
library(dplyr)
################################################################################
# traitement de Sonar
t1Sonar=Sys.time()#t debut
datasetSonar= Sonar
head(datasetSonar)
#> head(datasetSonar)
#V1     V2     V3     V4     V5     V6     V7     V8     V9    V10    V11    V12    V13    V14
#1 0.0200 0.0371 0.0428 0.0207 0.0954 0.0986 0.1539 0.1601 0.3109 0.2111 0.1609 0.1582 0.2238 0.0645
#V15    V16    V17    V18    V19    V20    V21    V22    V23    V24    V25    V26    V27    V28
#1 0.0660 0.2273 0.3100 0.2999 0.5078 0.4797 0.5783 0.5071 0.4328 0.5550 0.6711 0.6415 0.7104 0.8080
#V29    V30    V31    V32    V33    V34    V35    V36    V37    V38    V39    V40    V41    V42
#1 0.6791 0.3857 0.1307 0.2604 0.5121 0.7547 0.8537 0.8507 0.6692 0.6097 0.4943 0.2744 0.0510 0.2834
#V43    V44    V45    V46    V47    V48    V49    V50    V51    V52    V53    V54    V55    V56
#1 0.2825 0.4256 0.2641 0.1386 0.1051 0.1343 0.0383 0.0324 0.0232 0.0027 0.0065 0.0159 0.0072 0.0167
#V57    V58    V59    V60 Class
#1 0.0180 0.0084 0.0090 0.0032     R
#>
#______________________________________________
#les variables d'entrés sont V1,V2,...,V60
#la variable de sortie est Class(M,R) 
################################################################################
#Partitionner le dataset en échantillon test
TestSonar = select(datasetSonar, -61) #on supprime la variable de sortie Class
################################################################################
#Effectuer Naive bayes sur le dataset d'apprentissage
nbSonar.model <- naiveBayes(Class ~ ., data = datasetSonar)
nbSonar.model
#
#>nbSonar.model
# 
# Naive Bayes Classifier for Discrete Predictors
# 
# Call:
#   naiveBayes.default(x = X, y = Y, laplace = laplace)
# 
# A-priori probabilities:
#   Y
# M         R 
# 0.5336538 0.4663462 
# 
# Conditional probabilities:
#   V1
# Y         [,1]       [,2]
# M 0.03498919 0.02707424
# R 0.02249794 0.01468703
# 
# V2
# Y         [,1]       [,2]
# M 0.04554414 0.03783989
# R 0.03030309 0.02401111
# 
# V3
# Y         [,1]       [,2]
# M 0.05071982 0.04401370
# R 0.03595052 0.02910056
# 
# V4
# Y         [,1]       [,2]
# M 0.06476757 0.05449673
# R 0.04144742 0.03117239
# 
# V5
# Y         [,1]       [,2]
# M 0.08671532 0.05979019
# R 0.06202784 0.04721699
# 
# V6
# Y         [,1]       [,2]
# M 0.11186396 0.05261971
# R 0.09622371 0.06502488
# 
# V7
# Y        [,1]       [,2]
# M 0.1283586 0.05817913
# R 0.1141804 0.06515510
# 
# V8
# Y        [,1]       [,2]
# M 0.1498324 0.08719015
# R 0.1175959 0.07977235
# 
# V9
# Y        [,1]       [,2]
# M 0.2134919 0.12223715
# R 0.1373918 0.09988655
# 
# V10
# Y        [,1]      [,2]
# M 0.2510216 0.1373660
# R 0.1593247 0.1131511
# 
# V11
# Y        [,1]      [,2]
# M 0.2895811 0.1253595
# R 0.1747134 0.1133632
# 
# V12
# Y        [,1]      [,2]
# M 0.3014586 0.1241488
# R 0.1915887 0.1346711
# 
# V13
# Y        [,1]      [,2]
# M 0.3144261 0.1307424
# R 0.2262495 0.1380817
# 
# V14
# Y        [,1]      [,2]
# M 0.3206919 0.1597383
# R 0.2689629 0.1662835
# 
# V15
# Y        [,1]      [,2]
# M 0.3311820 0.1930656
# R 0.3076361 0.2190548
# 
# V16
# Y        [,1]      [,2]
# M 0.3809991 0.2119291
# R 0.3756113 0.2554010
# 
# V17
# Y        [,1]      [,2]
# M 0.4150072 0.2396802
# R 0.4171000 0.2899793
# 
# V18
# Y        [,1]      [,2]
# M 0.4558820 0.2552755
# R 0.4482402 0.2697813
# 
# V19
# Y        [,1]      [,2]
# M 0.5380622 0.2541079
# R 0.4667619 0.2584318
# 
# V20
# Y        [,1]      [,2]
# M 0.6179414 0.2540872
# R 0.5002289 0.2594326
# 
# V21
# Y        [,1]      [,2]
# M 0.6674261 0.2524101
# R 0.5422701 0.2487530
# 
# V22
# Y        [,1]      [,2]
# M 0.6723252 0.2427584
# R 0.5692897 0.2606390
# 
# V23
# Y        [,1]      [,2]
# M 0.6767009 0.2528500
# R 0.6129588 0.2439411
# 
# V24
# Y        [,1]      [,2]
# M 0.6891649 0.2440366
# R 0.6537608 0.2331786
# 
# V25
# Y        [,1]      [,2]
# M 0.6812036 0.2413845
# R 0.6688093 0.2500094
# 
# V26
# Y        [,1]      [,2]
# M 0.7060748 0.2367516
# R 0.6927619 0.2388017
# 
# V27
# Y        [,1]      [,2]
# M 0.7147541 0.2664100
# R 0.6877371 0.2200129
# 
# V28
# Y        [,1]      [,2]
# M 0.7122694 0.2610299
# R 0.6731454 0.2059348
# 
# V29
# Y        [,1]      [,2]
# M 0.6502829 0.2459369
# R 0.6326804 0.2344907
# 
# V30
# Y        [,1]      [,2]
# M 0.5817964 0.2101752
# R 0.5799340 0.2333608
# 
# V31
# Y        [,1]      [,2]
# M 0.4823784 0.2228015
# R 0.5297619 0.2016191
# 
# V32
# Y        [,1]      [,2]
# M 0.4280486 0.2136420
# R 0.4516186 0.2131804
# 
# V33
# Y        [,1]      [,2]
# M 0.3965775 0.1954610
# R 0.4408412 0.2170848
# 
# V34
# Y        [,1]      [,2]
# M 0.3661396 0.2062253
# R 0.4456804 0.2513125
# 
# V35
# Y        [,1]      [,2]
# M 0.3375532 0.2454556
# R 0.4555299 0.2612497
# 
# V36
# Y        [,1]      [,2]
# M 0.3185532 0.2484269
# R 0.4607103 0.2623106
# 
# V37
# Y        [,1]      [,2]
# M 0.3170342 0.2281491
# R 0.4173299 0.2429863
# 
# V38
# Y        [,1]      [,2]
# M 0.3316081 0.2037180
# R 0.3488680 0.2238046
# 
# V39
# Y        [,1]      [,2]
# M 0.3363649 0.1831229
# R 0.3137093 0.2162234
# 
# V40
# Y        [,1]      [,2]
# M 0.3052207 0.1618063
# R 0.3180567 0.1968227
# 
# V41
# Y        [,1]      [,2]
# M 0.2925937 0.1663377
# R 0.2854278 0.1772061
# 
# V42
# Y        [,1]      [,2]
# M 0.3009748 0.1686660
# R 0.2523381 0.1658745
# 
# V43
# Y        [,1]      [,2]
# M 0.2768829 0.1398055
# R 0.2118216 0.1303015
# 
# V44
# Y        [,1]      [,2]
# M 0.2481063 0.1444179
# R 0.1751320 0.1074217
# 
# V45
# Y        [,1]       [,2]
# M 0.2452252 0.17405343
# R 0.1423124 0.09566278
# 
# V46
# Y        [,1]       [,2]
# M 0.1988036 0.15139529
# R 0.1169495 0.09383959
# 
# V47
# Y         [,1]       [,2]
# M 0.14691712 0.09447378
# R 0.09445773 0.06776517
# 
# V48
# Y         [,1]       [,2]
# M 0.11059369 0.06711826
# R 0.06948763 0.04824403
# 
# V49
# Y         [,1]       [,2]
# M 0.06370811 0.03638205
# R 0.03844948 0.03044101
# 
# V50
# Y         [,1]       [,2]
# M 0.02272072 0.01422587
# R 0.01779588 0.01255689
# 
# V51
# Y         [,1]        [,2]
# M 0.01935225 0.013527923
# R 0.01231134 0.008632254
# 
# V52
# Y         [,1]        [,2]
# M 0.01601351 0.010770477
# R 0.01045258 0.007108769
# 
# V53
# Y          [,1]        [,2]
# M 0.011643243 0.007658277
# R 0.009640206 0.006174134
# 
# V54
# Y          [,1]        [,2]
# M 0.012184685 0.008462508
# R 0.009517526 0.005388723
# 
# V55
# Y          [,1]        [,2]
# M 0.009922523 0.008404498
# R 0.008567010 0.005137195
# 
# V56
# Y          [,1]        [,2]
# M 0.008913514 0.006403131
# R 0.007429897 0.004772931
# 
# V57
# Y          [,1]        [,2]
# M 0.007825225 0.005883652
# R 0.007814433 0.005701590
# 
# V58
# Y         [,1]        [,2]
# M 0.00906036 0.007459604
# R 0.00667732 0.004841003
# 
# V59
# Y          [,1]        [,2]
# M 0.008695495 0.006917151
# R 0.007078351 0.005114139
# 
# V60
# Y          [,1]        [,2]
# M 0.006929730 0.005957922
#R 0.006023711 0.003669008

summary(datasetSonar)
dim(datasetSonar)

#Prédire les sorties de l'échantillon de test:
PredSonar=predict(object = nbSonar.model, newdata = TestSonar)
PredSonar
# > PredSonar
# [1] R M M R M R M R R R R R R R R R M R R M R R M R R R R R R R R R R R R R R R R R R R R R M R R R R
# [50] R R R R R R R R R R R R R R R R R R R R R R R R R R R R R R R R M R R R M R M R R R R R R R R R M
# [99] M M M M M R M M R R M M R M M R M M M M R M R R M R M M M M M M M M M M M M M M M M M M M M M M M
# [148] M M M R R R R R R M M M M M M R R M R M R R R R M R R M M M R R R M M M M M M M R R R R R R R R R
# [197] M R R R M R R M R R R R
# Levels: M R
################################################################################
#Concaténer les sorties prédites et les véritable sorties
TestSonar.mod <- cbind(TestSonar, PredSonar)
head(TestSonar.mod, 5)
#> head(TestSonar.mod, 5)
# V1     V2     V3     V4     V5     V6     V7     V8     V9    V10    V11    V12    V13    V14
# 1 0.0200 0.0371 0.0428 0.0207 0.0954 0.0986 0.1539 0.1601 0.3109 0.2111 0.1609 0.1582 0.2238 0.0645
# 2 0.0453 0.0523 0.0843 0.0689 0.1183 0.2583 0.2156 0.3481 0.3337 0.2872 0.4918 0.6552 0.6919 0.7797
# 3 0.0262 0.0582 0.1099 0.1083 0.0974 0.2280 0.2431 0.3771 0.5598 0.6194 0.6333 0.7060 0.5544 0.5320
# 4 0.0100 0.0171 0.0623 0.0205 0.0205 0.0368 0.1098 0.1276 0.0598 0.1264 0.0881 0.1992 0.0184 0.2261
# 5 0.0762 0.0666 0.0481 0.0394 0.0590 0.0649 0.1209 0.2467 0.3564 0.4459 0.4152 0.3952 0.4256 0.4135
# V15    V16    V17    V18    V19    V20    V21    V22    V23    V24    V25    V26    V27    V28
# 1 0.0660 0.2273 0.3100 0.2999 0.5078 0.4797 0.5783 0.5071 0.4328 0.5550 0.6711 0.6415 0.7104 0.8080
# 2 0.7464 0.9444 1.0000 0.8874 0.8024 0.7818 0.5212 0.4052 0.3957 0.3914 0.3250 0.3200 0.3271 0.2767
# 3 0.6479 0.6931 0.6759 0.7551 0.8929 0.8619 0.7974 0.6737 0.4293 0.3648 0.5331 0.2413 0.5070 0.8533
# 4 0.1729 0.2131 0.0693 0.2281 0.4060 0.3973 0.2741 0.3690 0.5556 0.4846 0.3140 0.5334 0.5256 0.2520
# 5 0.4528 0.5326 0.7306 0.6193 0.2032 0.4636 0.4148 0.4292 0.5730 0.5399 0.3161 0.2285 0.6995 1.0000
# V29    V30    V31    V32    V33    V34    V35    V36    V37    V38    V39    V40    V41    V42
# 1 0.6791 0.3857 0.1307 0.2604 0.5121 0.7547 0.8537 0.8507 0.6692 0.6097 0.4943 0.2744 0.0510 0.2834
# 2 0.4423 0.2028 0.3788 0.2947 0.1984 0.2341 0.1306 0.4182 0.3835 0.1057 0.1840 0.1970 0.1674 0.0583
# 3 0.6036 0.8514 0.8512 0.5045 0.1862 0.2709 0.4232 0.3043 0.6116 0.6756 0.5375 0.4719 0.4647 0.2587
# 4 0.2090 0.3559 0.6260 0.7340 0.6120 0.3497 0.3953 0.3012 0.5408 0.8814 0.9857 0.9167 0.6121 0.5006
# 5 0.7262 0.4724 0.5103 0.5459 0.2881 0.0981 0.1951 0.4181 0.4604 0.3217 0.2828 0.2430 0.1979 0.2444
# V43    V44    V45    V46    V47    V48    V49    V50    V51    V52    V53    V54    V55    V56
# 1 0.2825 0.4256 0.2641 0.1386 0.1051 0.1343 0.0383 0.0324 0.0232 0.0027 0.0065 0.0159 0.0072 0.0167
# 2 0.1401 0.1628 0.0621 0.0203 0.0530 0.0742 0.0409 0.0061 0.0125 0.0084 0.0089 0.0048 0.0094 0.0191
# 3 0.2129 0.2222 0.2111 0.0176 0.1348 0.0744 0.0130 0.0106 0.0033 0.0232 0.0166 0.0095 0.0180 0.0244
# 4 0.3210 0.3202 0.4295 0.3654 0.2655 0.1576 0.0681 0.0294 0.0241 0.0121 0.0036 0.0150 0.0085 0.0073
# 5 0.1847 0.0841 0.0692 0.0528 0.0357 0.0085 0.0230 0.0046 0.0156 0.0031 0.0054 0.0105 0.0110 0.0015
# V57    V58    V59    V60 PredSonar
# 1 0.0180 0.0084 0.0090 0.0032         R
# 2 0.0140 0.0049 0.0052 0.0044         M
# 3 0.0316 0.0164 0.0095 0.0078         M
# 4 0.0050 0.0044 0.0040 0.0117         R
# 5 0.0072 0.0048 0.0107 0.0094         M
#
#
#Déterminer la table de confusion
ConfusionSonar = table(datasetSonar$Class, TestSonar.mod$PredSonar)
ConfusionSonar
#> ConfusionSonar
# 
# M  R
# M 66 45
# R 11 86
#
########################################################
#Calculer l'erreur du test.
errSonar <- 1-sum(diag(ConfusionSonar))/sum(ConfusionSonar)
errSonar
# > errSonar
# [1] 0.2692308
#> 

#######################################################
teSonar=t1Sonar-Sys.time()
teSonar

# > teSonar
# Time difference of -0.184396 secs
